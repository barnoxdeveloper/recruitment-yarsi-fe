<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Step-by-Step Form</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
        />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" />
        <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
        <div class="container-fluid mt-5">
            <div class="m-4">
                <div class="text-center mb-4">
                    <img src="images/logo.png" alt="Bootstrap" class="mb-3" />
                    <h1 class="fs-4">FORMULIR APLIKASI CALON PEGAWAI RUMAH SAKIT YARSI</h1>
                    <h3 class="fs-5">(APLICATION FORM FOR CANDIDATE OF RUMAH SAKIT YARSI)</h3>
                    <hr />
                </div>
                <form id="multi-step-form" enctype="multipart/form-data">
                    <!-- Data Pribadi -->
                    <fieldset id="candidates">
                        <div class="card mb-3">
                            <div class="card-body">
                                <h3 class="fs-4">Data Pribadi</h3>
                                <h4 class="fs-5 mb-4 fst-italic">(Personal Information)</h4>
                                <div class="row g-3">
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="first-name-candidate" class="form-label"
                                                >Nama Depan <span class="fst-italic">(First Name)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="first_name"
                                                id="first-name-candidate"
                                                placeholder="Nama Depan (First Name)"
                                                maxlength="100"
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="middle-name-candidate" class="form-label"
                                                >Nama Tengah <span class="fst-italic">(Middle Name)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="middle_name"
                                                id="middle-name-candidate"
                                                placeholder="Nama Tengah (Middle Name)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="last-name-candidate" class="form-label"
                                                >Nama Belakang <span class="fst-italic">(Last Name)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="last_name"
                                                id="last-name-candidate"
                                                placeholder="Nama Belakang (Last Name)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label class="form-label">Jenis Kelamin <span class="fst-italic">(Gender)</span>*</label>
                                            <br />
                                            <div class="form-check form-check-inline">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="sex_id_candidate"
                                                    id="sex-id-male-candidate"
                                                    value="1"
                                                    required
                                                />
                                                <label class="form-check-label" for="sex-id-male-candidate"
                                                    >Laki-laki <span class="fst-italic">(Male)</span></label
                                                >
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="sex_id_candidate"
                                                    id="sex-id-female-candidate"
                                                    value="2"
                                                    required
                                                />
                                                <label class="form-check-label" for="sex-id-female-candidate"
                                                    >Perempuan <span class="fst-italic">(Female)</span></label
                                                >
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="legal-identity-number-candidate" class="form-label"
                                                >No. KTP <span class="fst-italic">(ID Number)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="legal_identity_number"
                                                id="legal-identity-number-candidate"
                                                placeholder="No. KTP (ID Number)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="tax-identify-number-candidate" class="form-label"
                                                >No. NPWP <span class="fst-italic">(Tax ID Number)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="tax_identify_number"
                                                id="tax-identify-number-candidate"
                                                placeholder="No. NPWP (Tax ID Number)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="legal-address-candidate" class="form-label"
                                                >Alamat KTP <span class="fst-italic">(ID address)</span>*</label
                                            >
                                            <textarea
                                                class="form-control"
                                                name="legal_address"
                                                id="legal-address-candidate"
                                                rows="3"
                                                placeholder="Alamat KTP (ID address)"
                                                required
                                            ></textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="current-address-candidate" class="form-label"
                                                >Alamat saat ini <span class="fst-italic">(Current Address)</span>*</label
                                            >
                                            <textarea
                                                class="form-control"
                                                name="current_address"
                                                id="current-address-candidate"
                                                rows="3"
                                                placeholder="Alamat saat ini (Current Address)"
                                                required
                                            ></textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="phone-number-candidate" class="form-label"
                                                >No. Handphone <span class="fst-italic">(Phone Number)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="phone_number"
                                                id="phone-number-candidate"
                                                placeholder="No. Handphone (Phone Number)"
                                                required
                                                maxlength="20"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="home-phone-number-candidate" class="form-label"
                                                >No. Telepon Rumah <span class="fst-italic">(Home Phone Number)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="home_phone_number"
                                                id="home-phone-number-candidate"
                                                placeholder="No. Telepon Rumah (Home Phone Number)"
                                                required
                                                maxlength="20"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="email-candidate" class="form-label"
                                                >Alamat Email <span class="fst-italic">(Email Address)</span>*</label
                                            >
                                            <input
                                                type="email"
                                                class="form-control"
                                                name="email"
                                                id="email-candidate"
                                                placeholder="Alamat Email (Email Address)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="birth-place-candidate" class="form-label"
                                                >Tempat Lahir <span class="fst-italic">(Place of Birth)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="birth_place"
                                                id="birth-place-candidate"
                                                placeholder="Tempat Lahir(Place of Birth)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="birth-date-candidate" class="form-label"
                                                >Tanggal Lahir <span class="fst-italic">(Date of Birth)</span>*</label
                                            >
                                            <input
                                                type="date"
                                                class="form-control"
                                                name="birth_date"
                                                id="birth-date-candidate"
                                                placeholder="Tanggal Lahir(Date of Birth)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="marital-status-id-candidate" class="form-label"
                                                >Status Pernikahan <span class="fst-italic">(Marital Status)</span>*</label
                                            >
                                            <select
                                                class="form-select"
                                                aria-label="marital-status-id-candidate"
                                                name="marital_status_id"
                                                id="marital-status-id-candidate"
                                                required
                                            ></select>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="religion-id-candidate" class="form-label"
                                                >Agama <span class="fst-italic">(Religion)</span>*</label
                                            >
                                            <select
                                                class="form-select"
                                                aria-label="religion-id-candidate"
                                                name="religion_id"
                                                id="religion-id-candidate"
                                                required
                                            ></select>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="ethnic-id-candidate" class="form-label"
                                                >Suku Bangsa <span class="fst-italic">(ethnic)</span>*</label
                                            >
                                            <select
                                                class="form-control select2"
                                                aria-label="ethnic-id-candidate"
                                                name="ethnic_id"
                                                id="ethnic-id-candidate"
                                                required
                                                style="width: 100%"
                                            ></select>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="weight-candidate" class="form-label"
                                                >Berat Badan <span class="fst-italic">(Weight)</span>*</label
                                            >
                                            <input
                                                type="number"
                                                class="form-control"
                                                name="weight"
                                                id="weight-candidate"
                                                placeholder="Berat Badan (Weight)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="height-candidate" class="form-label"
                                                >Tinggi Badan <span class="fst-italic">(Height)</span>*</label
                                            >
                                            <input
                                                type="number"
                                                class="form-control"
                                                name="height"
                                                id="height-candidate"
                                                placeholder="Tinggi Badan (Height)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="file-cv" class="form-label"
                                                >Daftar Riwayat Hidup <span class="fst-italic">(Curriculum Vitae)</span>*</label
                                            >
                                            <input type="file" class="form-control" name="file_cv" id="file-cv" required accept="application/pdf" />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="file-photo" class="form-label">Pas Photo 3x4*</label>
                                            <input
                                                type="file"
                                                class="form-control"
                                                name="file_photo"
                                                id="file-photo"
                                                accept="image/png, image/jpg, image/jpeg"
                                                required
                                            />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset id="emergency_contact_candidates">
                        <div class="card mb-3">
                            <div class="card-body">
                                <h3 class="fs-4">Keluarga Yang Bisa Dihubungi Dalam Keadaan Darurat</h3>
                                <h4 class="fs-5 mb-4 fst-italic">(Family Member / Who can be Contacted In an Emergency)</h4>
                                <div class="row g-3">
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="relationship_id" class="form-label"
                                                >Hubungan
                                                <span class="fst-italic">(Relation)</span>
                                                *</label
                                            >
                                            <select
                                                class="form-select"
                                                aria-label="relationship_id"
                                                name="relationship_id"
                                                id="relationship-id-emergency-contact-candidates"
                                                required
                                            ></select>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="name" class="form-label">Nama <span class="fst-italic">(Name)</span>*</label>
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="name"
                                                id="name-emergency-contact-candidates"
                                                placeholder="Nama (name)"
                                                required
                                                maxlength="100"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label class="form-label">Jenis Kelamin <span class="fst-italic">(Gender)</span>*</label>
                                            <br />
                                            <div class="form-check form-check-inline">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="sex_id"
                                                    id="sex-id-male-emergency-contact-candidates"
                                                    value="1"
                                                    required
                                                />
                                                <label class="form-check-label" for="sex-id-male-emergency-contact-candidates"
                                                    >Laki-laki <span class="fst-italic">(Male)</span></label
                                                >
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="sex_id"
                                                    id="sex-id-female-emergency-contact-candidates"
                                                    value="2"
                                                    required
                                                />
                                                <label class="form-check-label" for="sex-id-female-emergency-contact-candidates"
                                                    >Perempuan <span class="fst-italic">(Female)</span></label
                                                >
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="phone-number-emergency-contact-candidates" class="form-label"
                                                >No. Handphone <span class="fst-italic">(Phone Number)</span>*</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="phone_number"
                                                id="phone-number-emergency-contact-candidates"
                                                placeholder="No. Handphone (Phone Number)"
                                                required
                                                maxlength="20"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group mb-3">
                                            <label for="address-emergency-contact-candidates" class="form-label"
                                                >Alamat <span class="fst-italic">(Address)</span>*</label
                                            >
                                            <textarea
                                                class="form-control"
                                                name="address"
                                                id="address-emergency-contact-candidates"
                                                rows="3"
                                                placeholder="Alamat (Address)"
                                                required
                                            ></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <!-- <div class="g-recaptcha mb-3" data-sitekey="your_site_key"></div> -->
                    <div class="d-flex justify-content-center mb-5">
                        <div class="navigation-buttons mt-3">
                            <button type="button" class="btn btn-danger prev-step">
                                Previous
                                <i class="bi bi-arrow-left"></i>
                            </button>
                            <button type="button" class="btn btn-success next-step">
                                Next
                                <i class="bi bi-arrow-right"></i>
                            </button>
                            <button
                                type="submit"
                                data-sitekey="6Lfm1OopAAAAAMn7VU9TV8-1lkmi_DTtyfIi6KKC"
                                data-callback="onSubmit"
                                data-action="submit"
                                class="btn btn-primary submit-button"
                            >
                                Submit
                                <i class="bi bi-send-check"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
            integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/store.js/2.0.1/store.legacy.min.js"
            integrity="sha512-XbzqqqogVHe2RPEnKNxzuW+57fuEDGL4O6wdxh/W75oJjbgpwa1KHB4XpUZ2rMT/hhRUI1L1n9hNpMvSJb6DiA=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        <!-- <script src="https://www.google.com/recaptcha/api.js"></script> -->
        <script>
            $(document).ready(function () {
                $.ajaxSetup({
                    headers: {
                        "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content"),
                    },
                });
                $("#ethnic-id-candidate").select2({
                    width: "100%", // Ensure the width is set to 100% to make it responsive
                });
                getJobVacancy();
                getMaritalStatus();
                getReligions();
                getEthnics();
                getRelationship();
                getEducations();
                getJobs();
                getDepartments();
                getPositions();

                let currentStep = 0;
                let steps = $("fieldset");
                let $prevButton = $(".prev-step");
                let $nextButton = $(".next-step");
                let $submitButton = $(".submit-button");

                function showStep(step) {
                    steps.removeClass("active");
                    steps.eq(step).addClass("active");

                    $prevButton.toggle(step > 0);
                    $nextButton.toggle(step < steps.length - 1);
                    $submitButton.toggle(step === steps.length - 1);
                }

                function validateStep(step) {
                    let inputs = steps.eq(step).find(":input[required]");
                    let isValid = true;
                    inputs.each(function () {
                        if (!this.checkValidity()) {
                            isValid = false;
                            $(this).addClass("is-invalid");
                        } else {
                            $(this).removeClass("is-invalid");
                        }
                    });
                    return isValid;
                }

                function saveStepData(step) {
                    let fieldsetID = steps.eq(step).attr("id");
                    if (fieldsetID === "family_informations") {
                        saveFamilyInformations();
                    } else if (fieldsetID === "family_members") {
                        saveFamilyMembers();
                    } else if (fieldsetID === "organization_experiences") {
                        saveOrganizationExperiences();
                    } else if (fieldsetID === "expertise_certification") {
                        saveExpertiseCertification();
                    } else if (fieldsetID === "courses_training") {
                        saveCoursesTraining();
                    } else if (fieldsetID === "foreign_languages") {
                        saveForeignLanguage();
                    } else if (fieldsetID === "work_experience") {
                        saveWorkExperience();
                    } else {
                        let inputs = steps.eq(step).find(":input");
                        let stepData = {};
                        inputs.each(function () {
                            stepData[this.name] = $(this).val();
                        });
                        store.set(fieldsetID, stepData);
                    }
                }

                function loadStepData(step) {
                    let fieldsetID = steps.eq(step).attr("id");
                    let stepData = store.get(fieldsetID);
                    if (stepData) {
                        let inputs = steps.eq(step).find(":input");
                        inputs.each(function () {
                            if (this.type === "file") {
                                // Skip file input elements
                                return;
                            } else if (this.type === "radio" || this.type === "checkbox") {
                                // For radio and checkbox inputs
                                $(this).prop("checked", stepData[this.name] == this.value);
                            } else {
                                // For other inputs
                                $(this).val(stepData[this.name]);
                            }
                        });
                    }
                }

                // family information
                function saveFamilyInformations() {
                    let familyInformations = store.get("family_informations") || []; // Default to empty array if not set
                    let relationship = $("#relationship-id-family-information-candidates").val();
                    let name = $("#name-family-information-candidates").val();
                    let sex_id = $('input[name="sex_id_family_information"]:checked').val();
                    let birth_place = $("#birth-place-family-information-candidates").val();
                    let birth_date = $("#birth-date-family-information-candidates").val();
                    let education = $("#education-id-family-information-candidates").val();
                    let job = $("#job-id-family-information-candidates").val();
                    if (relationship && name && sex_id && birth_place && birth_date && education && job) {
                        familyInformations.push({
                            relationship: relationship,
                            name: name,
                            sex_id: sex_id,
                            birth_place: birth_place,
                            birth_date: birth_date,
                            education: education,
                            job: job,
                        });
                    }
                    store.set("family_informations", familyInformations);
                    $("#family_informations :input").prop("required", false);
                    $("#family_informations :input").each(function () {
                        if ($(this).is(":radio") || $(this).is(":checkbox")) {
                            $(this).prop("checked", false);
                        } else {
                            $(this).val("");
                        }
                    });
                    // Remove required attribute
                    $("#family_informations :input").prop("required", false);
                    renderFamilyInformationTable();
                }

                function renderFamilyInformationTable() {
                    let familyInformations = store.get("family_informations") || [];
                    let $tableBody = $("#table-family-information tbody");
                    $tableBody.empty();
                    familyInformations.forEach(function (member) {
                        let html = `
                            <tr>
                                <td>${member.relationship}</td>
                                <td>${member.name}</td>
                                <td>${member.sex_id}</td>
                                <td>${member.birth_place}</td>
                                <td>${member.birth_date}</td>
                                <td>${member.education}</td>
                                <td>${member.job}</td>
                            </tr>
                        `;
                        $tableBody.append(html);
                    });
                }

                $("#btn-save-family-information").click(function () {
                    if (validateStep(currentStep)) {
                        saveFamilyInformations();
                    }
                });
                // family information end

                // family member start
                function saveFamilyMembers() {
                    let familyMembers = store.get("family_members") || []; // Default to empty array if not set
                    let relationship = $("#relationship-id-family-member-candidates").val();
                    let name = $("#name-family-member-candidates").val();
                    let sex_id = $('input[name="sex_id_family_member"]:checked').val();
                    let birth_place = $("#birth-place-family-member-candidates").val();
                    let birth_date = $("#birth-date-family-member-candidates").val();
                    let education = $("#education-id-family-member-candidates").val();
                    let job = $("#job-id-family-member-candidates").val();

                    // Check if both relationship and name have values before pushing
                    if (relationship && name && sex_id && birth_place && birth_date && education && job) {
                        familyMembers.push({
                            relationship: relationship,
                            name: name,
                            sex_id: sex_id,
                            birth_place: birth_place,
                            birth_date: birth_date,
                            education: education,
                            job: job,
                        });
                        console.info("aaaa");
                    }

                    store.set("family_members", familyMembers);
                    $("#family_members :input").prop("required", false);
                    $("#family_members :input").each(function () {
                        if ($(this).is(":radio") || $(this).is(":checkbox")) {
                            $(this).prop("checked", false);
                        } else {
                            $(this).val("");
                        }
                    });
                    renderFamilyMemberTable();
                }

                function renderFamilyMemberTable() {
                    let familyMembers = store.get("family_members") || [];
                    let $tableBody = $("#table-family-member tbody");
                    $tableBody.empty();
                    familyMembers.forEach(function (member) {
                        let html = `
                            <tr>
                                <td>${member.relationship}</td>
                                <td>${member.name}</td>
                                <td>${member.sex_id}</td>
                                <td>${member.birth_place}</td>
                                <td>${member.birth_date}</td>
                                <td>${member.education}</td>
                                <td>${member.job}</td>
                            </tr>
                        `;
                        $tableBody.append(html);
                    });
                }

                $("#btn-save-family-member").click(function () {
                    if (validateStep(currentStep)) {
                        saveFamilyMembers();
                    }
                });
                // family member end

                // organization start
                function saveOrganizationExperiences() {
                    let organizationExperiences = store.get("organization_experiences") || []; // Default to empty array if not set
                    let name = $("#organization-name-experience-candidates").val();
                    let position = $("#position-organization-experience-candidates").val();
                    let year = $("#year-organization-experience-candidates").val();
                    let description = $("#description-organization-experience-candidates").val();

                    if (name && position && year && description) {
                        organizationExperiences.push({
                            name: name,
                            position: position,
                            year: year,
                            description: description,
                        });
                    }

                    store.set("organization_experiences", organizationExperiences);
                    $("#organization_experiences :input").prop("required", false);
                    $("#organization_experiences :input").val("");
                    renderOrganizationExperiences();
                }

                function renderOrganizationExperiences() {
                    let organizationExperiences = store.get("organization_experiences") || [];
                    let $tableBody = $("#table-organization-experience tbody");
                    $tableBody.empty();
                    organizationExperiences.forEach(function (member) {
                        let html = `
                            <tr>
                                <td>${member.name}</td>
                                <td>${member.position}</td>
                                <td>${member.year}</td>
                                <td>${member.description}</td>
                            </tr>
                        `;
                        $tableBody.append(html);
                    });
                }

                $("#btn-save-organization-experience").click(function () {
                    if (validateStep(currentStep)) {
                        saveOrganizationExperiences();
                    }
                });
                // organization end

                // expertise certification start
                function saveExpertiseCertification() {
                    let expertiseCertification = store.get("expertise_certification") || []; // Default to empty array if not set
                    let type = $("#type-of-expertise-expertise-certification-candidates").val();
                    let level = $("#qualification-type-expertise-certification-candidates").val();
                    let given = $("#given-by-expertise-certification-candidates").val();
                    let year = $("#year-expertise-certification-candidates").val();
                    let description = $("#description-expertise-certification-candidates").val();

                    if (type && level && given && year && description) {
                        expertiseCertification.push({
                            type: type,
                            level: level,
                            given: given,
                            year: year,
                            description: description,
                        });
                    }

                    store.set("expertise_certification", expertiseCertification);
                    $("#expertise_certification :input").prop("required", false);
                    $("#expertise_certification :input").val("");
                    renderExpertiseCertification();
                }

                function renderExpertiseCertification() {
                    let expertiseCertification = store.get("expertise_certification") || [];
                    let $tableBody = $("#table-expertise-certification tbody");
                    $tableBody.empty();
                    expertiseCertification.forEach(function (member) {
                        let html = `
                            <tr>
                                <td>${member.type}</td>
                                <td>${member.level}</td>
                                <td>${member.given}</td>
                                <td>${member.year}</td>
                                <td>${member.description}</td>
                            </tr>
                        `;
                        $tableBody.append(html);
                    });
                }

                $("#btn-save-expertise-certification").click(function () {
                    if (validateStep(currentStep)) {
                        saveExpertiseCertification();
                    }
                });
                // expertise certification end

                // courses training start
                function saveCoursesTraining() {
                    let coursesTraining = store.get("courses_training") || []; // Default to empty array if not set
                    let type = $("#type-of-training-courses-training-candidates").val();
                    let level = $("#level-courses-training-candidates").val();
                    let organized = $("#organized-by-courses-training-candidates").val();
                    let year = $("#year-courses-training-candidates").val();
                    let description = $("#description-courses-training-candidates").val();

                    if (type && level && organized && year && description) {
                        coursesTraining.push({
                            type: type,
                            level: level,
                            organized: organized,
                            year: year,
                            description: description,
                        });
                    }

                    store.set("courses_training", coursesTraining);
                    $("#courses_training :input").prop("required", false);
                    $("#courses_training :input").val("");
                    renderCoursesTraining();
                }

                function renderCoursesTraining() {
                    let coursesTraining = store.get("courses_training") || [];
                    let $tableBody = $("#table-courses-training tbody");
                    $tableBody.empty();
                    coursesTraining.forEach(function (member) {
                        let html = `
                            <tr>
                                <td>${member.type}</td>
                                <td>${member.level}</td>
                                <td>${member.organized}</td>
                                <td>${member.year}</td>
                                <td>${member.description}</td>
                            </tr>
                        `;
                        $tableBody.append(html);
                    });
                }

                $("#btn-save-courses-training").click(function () {
                    if (validateStep(currentStep)) {
                        saveCoursesTraining();
                    }
                });
                // courses training end

                // foreign language start
                function saveForeignLanguage() {
                    let foreignLanguages = store.get("foreign_languages") || []; // Default to empty array if not set
                    let language = $("#language").val();
                    let speaking_ability_level = $("#speaking-ability-level").val();
                    let writing_ability_level = $("#writing-ability-level").val();

                    if (language && speaking_ability_level && writing_ability_level) {
                        foreignLanguages.push({
                            language: language,
                            speaking_ability_level: speaking_ability_level,
                            writing_ability_level: writing_ability_level,
                        });
                    }

                    store.set("foreign_languages", foreignLanguages);
                    $("#foreign_languages :input").prop("required", false);
                    $("#foreign_languages :input").val("");
                    renderForeignLanguage();
                }

                function renderForeignLanguage() {
                    let foreignLanguages = store.get("foreign_languages") || [];
                    let $tableBody = $("#table-foreign-language tbody");
                    $tableBody.empty();
                    foreignLanguages.forEach(function (member) {
                        let html = `
                            <tr>
                                <td>${member.language}</td>
                                <td>${member.speaking_ability_level}</td>
                                <td>${member.writing_ability_level}</td>
                            </tr>
                        `;
                        $tableBody.append(html);
                    });
                }

                $("#btn-save-foreign-language").click(function () {
                    if (validateStep(currentStep)) {
                        saveForeignLanguage();
                    }
                });
                // foreign language end

                // work experience start
                function saveWorkExperience() {
                    let workExperience = store.get("work_experience") || []; // Default to empty array if not set
                    let company = $("#company-work-experience").val();
                    let position = $("#position-work-experience").val();
                    let from_date = $("#from-date-work-experience").val();
                    let to_date = $("#to-date-work-experience").val();
                    let location = $("#location-work-experience").val();
                    let take_home_pay = $("#take-home-pay-work-experience").val();
                    let job_description = $("#job-description-work-experience").val();
                    let reason = $("#reason-for-resignation-work-experience").val();

                    if (language && position && from_date && to_date && location && take_home_pay && job_description && reason) {
                        workExperience.push({
                            company: company,
                            position: position,
                            from_date: from_date,
                            to_date: to_date,
                            location: location,
                            take_home_pay: take_home_pay,
                            job_description: job_description,
                            reason: reason,
                        });
                    }

                    store.set("work_experience", workExperience);
                    $("#work_experience :input").prop("required", false);
                    $("#work_experience :input").val("");
                    renderWorkExperience();
                }

                function renderWorkExperience() {
                    let workExperience = store.get("work_experience") || [];
                    let $tableBody = $("#table-work-experience tbody");
                    $tableBody.empty();
                    workExperience.forEach(function (member) {
                        let html = `
                            <tr>
                                <td>${member.company}</td>
                                <td>${member.position}</td>
                                <td>${member.from_date}</td>
                                <td>${member.to_date}</td>
                                <td>${member.location}</td>
                                <td>${member.take_home_pay}</td>
                                <td>${member.job_description}</td>
                                <td>${member.reason}</td>
                            </tr>
                        `;
                        $tableBody.append(html);
                    });
                }

                $("#btn-save-work-experience").click(function () {
                    if (validateStep(currentStep)) {
                        saveWorkExperience();
                    }
                });
                // work experience end

                // render table
                renderFamilyInformationTable();
                renderFamilyMemberTable();
                renderOrganizationExperiences();
                renderExpertiseCertification();
                renderCoursesTraining();
                renderForeignLanguage();
                renderWorkExperience();

                $nextButton.click(function () {
                    const currentFieldset = steps.eq(currentStep);
                    const fieldsetID = currentFieldset.attr("id");
                    if (store.get(fieldsetID) !== undefined) {
                        currentStep++;
                        loadStepData(currentStep);
                        showStep(currentStep);
                    } else {
                        if (validateStep(currentStep) && currentStep < steps.length - 1) {
                            saveStepData(currentStep);
                            currentStep++;
                            loadStepData(currentStep);
                            showStep(currentStep);
                        }
                    }
                });

                $prevButton.click(function () {
                    if (currentStep > 0) {
                        currentStep--;
                        loadStepData(currentStep);
                        showStep(currentStep);
                    }
                });

                $("#multi-step-form").submit(function (e) {
                    e.preventDefault();

                    if (!validateStep(currentStep)) {
                        return;
                    }

                    saveStepData(currentStep);

                    // Collect all data from local storage
                    let formData = {};
                    steps.each(function (index, step) {
                        let fieldsetID = $(step).attr("id");
                        let stepData = store.get(fieldsetID);
                        if (stepData) {
                            formData = { ...formData, ...stepData };
                        }
                    });
                    console.info(formData);

                    // Make the AJAX POST request
                    let token = $("meta[name='csrf-token']").attr("content");
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/apply",
                        type: "POST",
                        data: JSON.stringify(formData),
                        success: function (response) {
                            alert("Form submitted successfully!");
                            // You can add additional logic here, like redirecting the user
                            //location.reload();
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                            alert("An error occurred while submitting the form. Please try again.");
                        },
                    });
                    // Clear local storage
                    store.clearAll();
                });

                showStep(currentStep);
                loadStepData(currentStep);

                function onSubmit(token) {
                    document.getElementById("multi-step-form").submit();
                }

                function getJobVacancy() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#job-vacancy-id").empty();
                            $("#job-vacancy-id").append('<option value="" selected>Select Lowongan Kerja</option>');
                            $.each(response.data, function (key, value) {
                                $("#job-vacancy-id").append('<option value="' + value.id + '">' + value.title + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getMaritalStatus() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/marital-statuses",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#marital-status-id-candidate").empty();
                            $("#marital-status-id-candidate").append('<option value="" selected>Select Status</option>');
                            $.each(response.data, function (key, value) {
                                $("#marital-status-id-candidate").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getReligions() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/religions",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#religion-id-candidate").empty();
                            $("#religion-id-candidate").append('<option value="" selected>Select Religion</option>');
                            $.each(response.data, function (key, value) {
                                $("#religion-id-candidate").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getEthnics() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/ethnics",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#ethnic-id-candidate").empty();
                            $("#ethnic-id-candidate").append('<option value="" selected>Select Suku</option>');
                            $.each(response.data, function (key, value) {
                                $("#ethnic-id-candidate").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getRelationship() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/relationships",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#relationship-id-emergency-contact-candidates").empty();
                            $("#relationship-id-emergency-contact-candidates").append('<option value="" selected>Select Hubungan</option>');
                            $.each(response.data, function (key, value) {
                                $("#relationship-id-emergency-contact-candidates").append(
                                    '<option value="' + value.id + '">' + value.name + "</option>"
                                );
                            });

                            $("#relationship-id-family-information-candidates").empty();
                            $("#relationship-id-family-information-candidates").append('<option value="" selected>Select Hubungan</option>');
                            $.each(response.data, function (key, value) {
                                $("#relationship-id-family-information-candidates").append(
                                    '<option value="' + value.id + '">' + value.name + "</option>"
                                );
                            });

                            $("#relationship-id-family-member-candidates").empty();
                            $("#relationship-id-family-member-candidates").append('<option value="" selected>Select Hubungan</option>');
                            $.each(response.data, function (key, value) {
                                $("#relationship-id-family-member-candidates").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });

                            $("#relationship-id-hospital-connection").empty();
                            $("#relationship-id-hospital-connection").append('<option value="" selected>Select Hubungan</option>');
                            $.each(response.data, function (key, value) {
                                $("#relationship-id-hospital-connection").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getEducations() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/educations",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#education-id-family-information-candidates").empty();
                            $("#education-id-family-information-candidates").append('<option value="" selected>Select Pendidikan</option>');
                            $.each(response.data, function (key, value) {
                                $("#education-id-family-information-candidates").append(
                                    '<option value="' + value.id + '">' + value.name + "</option>"
                                );
                            });

                            $("#education-id-family-member-candidates").empty();
                            $("#education-id-family-member-candidates").append('<option value="" selected>Select Pendidikan</option>');
                            $.each(response.data, function (key, value) {
                                $("#education-id-family-member-candidates").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });

                            $("#education-id-education-background-candidates").empty();
                            $("#education-id-education-background-candidates").append('<option value="" selected>Select Pendidikan</option>');
                            $.each(response.data, function (key, value) {
                                $("#education-id-education-background-candidates").append(
                                    '<option value="' + value.id + '">' + value.name + "</option>"
                                );
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getJobs() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/jobs",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#job-id-family-information-candidates").empty();
                            $("#job-id-family-information-candidates").append('<option value="" selected>Select Pekerjaan</option>');
                            $.each(response.data, function (key, value) {
                                $("#job-id-family-information-candidates").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });

                            $("#job-id-family-member-candidates").empty();
                            $("#job-id-family-member-candidates").append('<option value="" selected>Select Pekerjaan</option>');
                            $.each(response.data, function (key, value) {
                                $("#job-id-family-member-candidates").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getPositions() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/positions",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#position-id-hospital-connection").empty();
                            $("#position-id-hospital-connection").append('<option value="" selected>Select Pekerjaan</option>');
                            $.each(response.data, function (key, value) {
                                $("#position-id-hospital-connection").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }

                function getDepartments() {
                    $.ajax({
                        url: "http://127.0.0.1:8000/api/public/job-vacancies/departments",
                        type: "GET",
                        dataType: "json",
                        success: function (response) {
                            $("#department-id-hospital-connection").empty();
                            $("#department-id-hospital-connection").append('<option value="" selected>Select Pekerjaan</option>');
                            $.each(response.data, function (key, value) {
                                $("#department-id-hospital-connection").append('<option value="' + value.id + '">' + value.name + "</option>");
                            });
                        },
                        error: function (xhr, status, error) {
                            console.error(xhr.responseText);
                        },
                    });
                }
            });
        </script>
    </body>
</html>
